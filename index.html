<!DOCTYPE html>
<html>
<head>
    <title>영화 데이터 목록</title>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.0.min.js"></script>

    <style>
        /* 테이블 기본 스타일 추가 (가독성 향상) */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f9f9f9;
        }
        #myInput {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            box-sizing: border-box;
            font-size: 16px;
        }
    </style>

    <script>
        $(function(){
            // GitHub Pages에서 JSON 파일을 비동기적으로 로드합니다.
            $.ajax({
                url: "./kobis2025.json",
                dataType: "json",
                success : function(data){
                    if(data.length > 0){
                        var tb = $("<table/>");
                        
                        // 테이블 헤더 (<thead>) 생성
                        var $thead = $("<thead/>").append(
                            $("<tr/>").append(
                                $("<th/>").text("순위"),
                                $("<th/>").text("영화명"),
                                $("<th/>").text("개봉일"),
                                $("<th/>").text("매출액"),
                                $("<th/>").text("점유율"),
                                $("<th/>").text("관객수"),
                                $("<th/>").text("스크린수")
                            )
                        );
                        tb.append($thead);

                        // 테이블 바디 (<tbody>) 내용 생성
                        var $tbody = $("<tbody/>");
                        
                        for(var i in data){
                            // JSON 키값에 맞게 변수명 변경 및 데이터 할당
                            var $rank = data[i].Rank;
                            var $title = data[i].Title;
                            var $releaseDate = data[i].ReleaseDate;
                            var $salesRevenue = data[i].SalesRevenue;
                            var $revenueShare = data[i].RevenueShare;
                            var $admissions = data[i].Admissions;
                            var $screenCount = data[i].ScreenCount;

                            var row = $("<tr/>").append(
                                $("<td/>").text($rank),
                                $("<td/>").text($title),
                                $("<td/>").text($releaseDate),
                                $("<td/>").text($salesRevenue),
                                $("<td/>").text($revenueShare),
                                $("<td/>").text($admissions),
                                $("<td/>").text($screenCount)
                            );

                            $tbody.append(row);
                        }
                        
                        tb.append($tbody);
                        $(".wrap").append(tb);
                    }
                },
                error: function(xhr, status, error) {
                    $(".wrap").text("데이터 로드 실패: " + status + " (" + error + ")");
                }
            });
        });
    </script>
</head>
<body>
    
    <div class="wrap"></div>
    
    <input id="myInput" type="text" placeholder="검색어를 입력하세요.."> 
    
    <script>
    //search
    $("#myInput").on("keyup", function() {
        var value = $(this).val().toLowerCase(); // 검색어 소문자 변환

        // 테이블 본문(tbody)의 모든 행(tr)에 대해 필터링
        $(".wrap tbody tr").filter(function() {
            // 행의 텍스트를 소문자로 변환하여 검색어 포함 여부 확인
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    });
    </script>
</body>
</html>
